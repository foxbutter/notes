# 微信支付

## 电商收付通

https://pay.weixin.qq.com/index.php/public/public_tools/index/toolkit/toolkit_details/3001

顺序：1.补差>分账；2.退款>退补差；3.退分账与否、回退时机无限制。

### 补差

1. 订单支付成功并结算完成后，发起分账前进行补差。
2. 取消补差的前提需要订单发生退款，在调用退款接口后调用取消补差接口

### 分账

1. 如果分账订单已经分账完结，用户申请退全款应该如何操作？
1. https://pay.weixin.qq.com/wiki/doc/api/allocation.php?chapter=26_4
2. 如果分账接收方类型为个人openid，则已分账到个人的分账金额无法回退，商家需自己补贴相应的分账金额给到用户
3. 如果分账接收方类型为商户号，则已分账到商户号的分账金额可以调用请求分账回退接口进行分账回退
温馨提示：退款和分账回退没有耦合，分账回退可以先于退款请求，也可以后于退款请求
2. 调用”请求分账“接口给多个分账接收方进行分账的情况下，会出现部分成功、部分失败的结果吗”？会的
3. 分账订单的退款与分账回退并无强耦合。分账回退的资金是回到商户可用余额中，分账回退可先于退款发起，亦可后于退款发起，或者，不发起分账回退。在二级商户余额充足的情况下，可以不发起回退，直接发起退款。是否需要分账回退，可由根据分账方与商户的约定决定。
4. 补差金额，如果有发生退款的话，补差金额可以随便填吗？都可以
